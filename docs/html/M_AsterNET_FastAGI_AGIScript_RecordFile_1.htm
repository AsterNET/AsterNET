<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AGIScript.RecordFile Method (String, String, String, Int32, Int32, Boolean, Int32)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:AsterNET.FastAGI.AGIScript.RecordFile(System.String,System.String,System.String,System.Int32,System.Int32,System.Boolean,System.Int32)" /><meta name="Description" content="Record to a file until a given dtmf digit in the sequence is received. Returns -1 on hangup or error. The format will specify what kind of file will be recorded. The timeout is the maximum record time in milliseconds, or -1 for no timeout." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="AsterNET.FastAGI" /><meta name="file" content="M_AsterNET_FastAGI_AGIScript_RecordFile_1" /><meta name="guid" content="M_AsterNET_FastAGI_AGIScript_RecordFile_1" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">AsterNet Class Library (Sandcastle documentation)<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\79b6241e-05a3-441c-b6a1-51f2b5b7f265.htm" title="AsterNet Class Library (Sandcastle documentation)" tocid="roottoc">AsterNet Class Library (Sandcastle documentation)</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_AsterNET_FastAGI.htm" title="AsterNET.FastAGI" tocid="N_AsterNET_FastAGI">AsterNET.FastAGI</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_AsterNET_FastAGI_AGIScript.htm" title="AGIScript Class" tocid="T_AsterNET_FastAGI_AGIScript">AGIScript Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_AsterNET_FastAGI_AGIScript.htm" title="AGIScript Methods" tocid="Methods_T_AsterNET_FastAGI_AGIScript">AGIScript Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_AsterNET_FastAGI_AGIScript_RecordFile.htm" title="RecordFile Method " tocid="Overload_AsterNET_FastAGI_AGIScript_RecordFile">RecordFile Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_AsterNET_FastAGI_AGIScript_RecordFile.htm" title="RecordFile Method (String, String, String, Int32)" tocid="M_AsterNET_FastAGI_AGIScript_RecordFile">RecordFile Method (String, String, String, Int32)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_AsterNET_FastAGI_AGIScript_RecordFile_1.htm" title="RecordFile Method (String, String, String, Int32, Int32, Boolean, Int32)" tocid="M_AsterNET_FastAGI_AGIScript_RecordFile_1">RecordFile Method (String, String, String, Int32, Int32, Boolean, Int32)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>AGIScript<span id="LSTF4887FEF_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF4887FEF_0?cpp=::|nu=.");</script>RecordFile Method (String, String, String, Int32, Int32, Boolean, Int32)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Record to a file until a given dtmf digit in the sequence is received.<br />
            Returns -1 on hangup or error.<br />
            The format will specify what kind of file will be recorded. The timeout is
            the maximum record time in milliseconds, or -1 for no timeout. Offset samples
            is optional, and if provided will seek to the offset without exceeding the
            end of the file. "maxSilence" is the number of seconds of maxSilence allowed
            before the function returns despite the lack of dtmf digits or reaching
            timeout.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_AsterNET_FastAGI.htm">AsterNET.FastAGI</a><br />
    <strong>Assembly:</strong>
   AsterNET (in AsterNET.dll) Version: 1.2.0.0 (1.2.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EDCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cs','1','4');return false;">C#</a></div><div id="ID0EDCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','vb','2','4');return false;">VB</a></div><div id="ID0EDCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cpp','3','4');return false;">C++</a></div><div id="ID0EDCA_tab4" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EDCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EDCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EDCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">protected</span> <span class="identifier">int</span> <span class="identifier">RecordFile</span>(
	<span class="identifier">string</span> <span class="parameter">file</span>,
	<span class="identifier">string</span> <span class="parameter">format</span>,
	<span class="identifier">string</span> <span class="parameter">escapeDigits</span>,
	<span class="identifier">int</span> <span class="parameter">timeout</span>,
	<span class="identifier">int</span> <span class="parameter">offset</span>,
	<span class="identifier">bool</span> <span class="parameter">beep</span>,
	<span class="identifier">int</span> <span class="parameter">maxSilence</span>
)</pre></div><div id="ID0EDCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Protected</span> <span class="keyword">Function</span> <span class="identifier">RecordFile</span> ( 
	<span class="parameter">file</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">format</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">escapeDigits</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">timeout</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">offset</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">beep</span> <span class="keyword">As</span> <span class="identifier">Boolean</span>,
	<span class="parameter">maxSilence</span> <span class="keyword">As</span> <span class="identifier">Integer</span>
) <span class="keyword">As</span> <span class="identifier">Integer</span></pre></div><div id="ID0EDCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">protected</span>:
<span class="identifier">int</span> <span class="identifier">RecordFile</span>(
	<span class="identifier">String</span>^ <span class="parameter">file</span>, 
	<span class="identifier">String</span>^ <span class="parameter">format</span>, 
	<span class="identifier">String</span>^ <span class="parameter">escapeDigits</span>, 
	<span class="identifier">int</span> <span class="parameter">timeout</span>, 
	<span class="identifier">int</span> <span class="parameter">offset</span>, 
	<span class="identifier">bool</span> <span class="parameter">beep</span>, 
	<span class="identifier">int</span> <span class="parameter">maxSilence</span>
)</pre></div><div id="ID0EDCA_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">RecordFile</span> : 
        <span class="parameter">file</span> : <span class="identifier">string</span> * 
        <span class="parameter">format</span> : <span class="identifier">string</span> * 
        <span class="parameter">escapeDigits</span> : <span class="identifier">string</span> * 
        <span class="parameter">timeout</span> : <span class="identifier">int</span> * 
        <span class="parameter">offset</span> : <span class="identifier">int</span> * 
        <span class="parameter">beep</span> : <span class="identifier">bool</span> * 
        <span class="parameter">maxSilence</span> : <span class="identifier">int</span> <span class="keyword">-&gt;</span> <span class="identifier">int</span> 
</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EDCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">file</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTF4887FEF_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF4887FEF_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />the name of the file to stream, must not include extension.</dd><dt><span class="parameter">format</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTF4887FEF_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF4887FEF_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />the format of the file to be recorded, for example "wav".</dd><dt><span class="parameter">escapeDigits</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTF4887FEF_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF4887FEF_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />contains the digits that allow the user to end recording.</dd><dt><span class="parameter">timeout</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LSTF4887FEF_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF4887FEF_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />the maximum record time in milliseconds, or -1 for no timeout.</dd><dt><span class="parameter">offset</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LSTF4887FEF_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF4887FEF_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />the offset samples to skip.</dd><dt><span class="parameter">beep</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System<span id="LSTF4887FEF_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF4887FEF_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Boolean</a><br />true if a beep should be played before recording.</dd><dt><span class="parameter">maxSilence</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LSTF4887FEF_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF4887FEF_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />The amount of silence (in seconds) to allow before returning despite the lack of dtmf digits or reaching timeout.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Int32</a><br />result code</div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_AsterNET_FastAGI_AGIScript.htm">AGIScript Class</a></div><div class="seeAlsoStyle"><a href="Overload_AsterNET_FastAGI_AGIScript_RecordFile.htm">RecordFile Overload</a></div><div class="seeAlsoStyle"><a href="N_AsterNET_FastAGI.htm">AsterNET.FastAGI Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>